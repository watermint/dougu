# Amazon S3 Storage System

This document describes the behavior of Amazon S3 storage system integration as implemented in the dougu library.

## File Deletion Behavior

Amazon S3 implements a file deletion system with the following characteristics:

- By default, S3 object deletion is immediate and permanent (no built-in trash/recycle bin)
- Versioning can be enabled on S3 buckets to preserve previous versions
- With versioning enabled:
  - Deletion adds a delete marker rather than actually removing the object
  - Previous versions remain retrievable until permanently deleted
  - Specific versions can be permanently deleted by version ID
- S3 Object Lock can prevent deletion for a fixed period or indefinitely (WORM - Write Once Read Many)
- S3 Lifecycle rules can automate:
  - Transition of objects to different storage classes
  - Expiration (deletion) of objects after a specified time
  - Expiration of older versions if versioning is enabled
  - Removal of delete markers and expired object delete markers
- Cross-Region Replication (CRR) can provide additional protection against accidental deletion
- Multi-Factor Authentication (MFA) Delete can be enabled for additional deletion protection
- S3 Access Points and bucket policies can restrict deletion permissions

### Storage Impact and Limits

- Deleted objects without versioning are removed immediately and stop incurring storage costs
- With versioning enabled, all versions (including delete markers) incur storage costs
- There is no built-in time limit for version retention without lifecycle rules
- S3 Intelligent-Tiering can automatically move infrequently accessed data to lower-cost tiers
- There are no specific limits on the number of versions that can be stored
- Storage costs vary by storage class and region
- API requests (including deletion operations) incur separate charges
- Lifecycle transitions between storage classes may have minimum storage duration requirements

### API Implementation Notes

In the dougu library implementation:

- `delete()` deletes an object (adds a delete marker if versioning is enabled)
- `permanently_delete()` deletes a specific version of an object by version ID
- `restore()` functionality is available only if versioning is enabled (restores previous versions)
- `list_deleted()` lists delete markers in a versioned bucket
- The implementation uses AWS SDK for S3
- S3 Select can be used for partial object retrieval
- Multipart upload support for large objects
- Support for server-side encryption
- Integration with AWS Identity and Access Management (IAM) for access control
- Support for S3 bucket event notifications when objects are deleted

For more details on the Amazon S3 API, refer to the [official Amazon S3 API documentation](https://docs.aws.amazon.com/AmazonS3/latest/API/Welcome.html) 